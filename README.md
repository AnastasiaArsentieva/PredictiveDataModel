# PredictiveDataModel

**Предиктивная модель по определению стоимости ценных бумаг**

На базе модели Prophet – построены предсказания стоимости бумаг первого эшелона.

**Цель работы:**

проанализировать поведение ликвидных ценных бумаг и спрогнозировать их стоимость до конца 2023 года

**Задачи:**

1. Сформировать датасет на основании исторических показателей торгов.
   
2. Рассмотреть и проанализировать трендовое поведение ценных бумаг.
Выбрать модель для прогноза данных и рассчитать метрики погрешностей моделей.

3. Выбрать наиболее подходящую модель прогнозирования, обосновав свой выбор.
   
4. Провести анализ результатов прогнозирования цен.

**В ходе работы - выполнено:**

**1.	Формирование датасета:**

Сформирован датасет из цен 15-ти самых крупных компаний российского рынка с 03.01.2023 по 29.12.2023.
По каждой компании получили 254 значения – 222 значения использовались для исследования (для тестовой и обучающей выборки), 32 значения - для сравнения с полученными прогнозными данными.
Визуализаци части набора данных

<img width="595" height="563" alt="image" src="https://github.com/user-attachments/assets/28f79b24-0dd3-4831-af55-db8fd0f950ad" />

**2.	Рассмотрено и проанализировано трендовое поведение ценных бумаг. Выбрана модель для прогноза данных и рассчитать метрики погрешностей моделей.**
Рассматривались методы моделей: скользящее среднее, модель Хольта, линейная регрессия, модель Prophet 
На общем фоне разного трендового поведения бумаг наиболее точные предсказания предоставлены моделью Prophet, которая состоит из ансамбля функций:

<img width="699" height="159" alt="image" src="https://github.com/user-attachments/assets/358be4e8-803d-4c4b-8021-714f3c887723" />

**g(t)** – это функция тренда, моделирующая непериодические изменения значений временного ряда,

**s(t)** – представляет собой периодические изменения (например, еженедельную и ежегодную сезонность),

**h(t)** – представляет собой поведение временного ряда в праздники, которые возникают в течение одного или нескольких дней,

**εt** – это доля ошибки, представляет собой любые случайные отклонений, которые не учитываются моделью.

Для оценки эффективности моделей использовалась	**метрика SMAPE** - абсолютная разность между наблюдаемым и предсказанным значениями, деленная на полусумму их модулей.


**В ходе анализа были получены следующие данные:**

1.	Графики рассеивания для определения сезонности и регрессора
2.	Графики тренда с пороговым коридором возможных значений
3.	Графики спрогнозированных данных простой модели на фоне реальных значений
4.	Графики данных с разбиением на обучающую и тестовую выборки

**Примеры полученных данных (не все данные, только часть):**
Графики рассеивания для определения сезонности и регрессоров
<img width="1151" height="818" alt="image" src="https://github.com/user-attachments/assets/a851a48e-84f1-4cac-be53-7e42be41f684" />
Графики тренда с пороговым коридором возможных значений
<img width="1207" height="816" alt="image" src="https://github.com/user-attachments/assets/21f1d5c6-103b-4b6c-80e7-a0d675e86b67" />
Графики спрогнозированных данных простой модели на фоне реальных значений
<img width="1248" height="760" alt="image" src="https://github.com/user-attachments/assets/3e4a0389-9f52-49a5-9d44-1837c6c2bd99" />
Графики данных с разбиением на обучающую и тестовую выборки
<img width="1248" height="779" alt="image" src="https://github.com/user-attachments/assets/4aefb6dd-7bb8-4bfe-af00-80eeb57f523c" />

**В ходе анализа были сделаны выводы:**
**анализ результатов: графики рассеивания для определения сезонности и регрессора**
1.	разное трендовое поведения акций в рамках одного диапазона (нисходящие, восходящие тренды, ломаные и неопределённые тренды)
2.	нет сезонности, которую необходимо учитывать в построении модели
3.	разное непредсказуемое поведение ценных бумаг может увеличивать погрешность прогнозов
**анализ результатов: графики тренда с пороговым коридором возможных значений**
1.	еженедельные тренды прогнозируют дальнейшее направление общего тренда
2.	коридоры пороговых значений разноразмерные и по некоторым акциям сильно широкие для точных предсказаний
3.	сильно сглаженное поведение тренда
**анализ результатов: графики спрогнозированных данных простой модели на фоне реальных значений**
1.	прогнозные значения наиболее точны в короткий период 5-10 дней
2.	прогнозные значения не учитывают резкие скачки цен – пиковые расхождения
3.	в прогнозе не учитываются новостные (политические) события
**анализ результатов: графики данных с разбиением на обучающую и тестовую выборки**
1.	прогнозы составлены на основании последнего тренда без учета возможных изменений
2.	широкие пороговые коридоры значений
3.	не учитываются скачки цен
4.	малый период не позволяет спрогнозировать более точный тренд

**Задача 3: Сделан выбор наиболее подходящей модели**
Проведен анализ результатов разных моделей, посредством сравнения показателей метрики SMAPE и сделаны выводы:
1.	Лучше всего себя показала простая модель Prophet
2.	Добавление регрессора не повлияло на улучшение результата
3.	Увеличение периода обучения – улучшает качество модели
4.	При улучшении усреднённого показателя – ряд моделей увеличили погрешность
   
<img width="974" height="688" alt="image" src="https://github.com/user-attachments/assets/135f4121-cbdf-4a59-b3d3-2f35056d2037" />

**Задача 4: Проведён анализ результатов прогнозирования цен**
1.	Наибольшую эффективность показала простая модель Prophet – погрешность не превысила 2%, модель более чем на 98% точна.
2.	По ряду бумаг получены достаточно точные прогнозы – расхождение менее 1%.
3.	Модель Prophet лучше всего спрогнозировала и дала наименьшее число погрешностей в первые 5-10 дней прогнозного периода по всем акциям, кроме Новатека.
4.	Для краткосрочных вложений подходит – Роснефть, Татнефть (они по графикам имели стабильный восходящий тренд и прогнозные значения показывали рост цены). С большим риском акции Алроса (начался восходящий тренд и по прогнозным значениям планировался рост цены) и Магнит (начался восходящий тренд, но риск, что по прогнозным значениям цена упадёт).







